$(document).ready(function() {
    var submitButton = $('#querySubmit');
    var queryInput = $('#query');
    var loaderHTML = `
      <div id="loader">
        <ul>
          <li><span>P</span></li>
          <li><span>R</span></li>
          <li><span>I</span></li>
          <li><span>C</span></li>
          <li><span>E</span></li>
          <li><span>N</span></li>
          <li><span>E</span></li>
          <li><span>T</span></li>
          <div style="width:50vw;" class="loader-line"></div>
        </ul>
      </div>
    `;

    submitButton.on('click', function(event) {
        event.preventDefault(); // Prevent the default form submission

        // Add the loader HTML code to the body
        $('body').html(loaderHTML);

        // Redirect to the specified URL
        var queryValue = queryInput.val();
        var url = '/?query=' + encodeURIComponent(queryValue) + '#results';
        window.location.href = url;
    });

    function populateDataList(options) {
        var datalist = $("#ac");
        datalist.empty(); // Clear existing options
    
        options.forEach(function(option) {
          datalist.append($("<option>").attr("value", option));
        });
      }

    function fetchAutocompleteSuggestions(term) {
        if (term.length >= 1) { // Check minimum length
          $.ajax({
            url: "/autocomplete",
            method: "GET",
            dataType: "json",
            data: {
              term: term
            },
            success: function(data) {
              populateDataList(data);
            }
          });
        }
      }
    
      // Handle input change event
      $("#query").on("input", function() {
        var term = $(this).val();
        fetchAutocompleteSuggestions(term);
      });

});

